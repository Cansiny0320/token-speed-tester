# Token é€Ÿåº¦æµ‹è¯•å·¥å…·

> ç”¨äºæµ‹é‡å’Œåˆ†æ LLM API Token æµå¼è¾“å‡ºæ€§èƒ½çš„å‘½ä»¤è¡Œå·¥å…·

[English](README.en.md) |

[![npm ç‰ˆæœ¬](https://badge.fury.io/js/token-speed-tester.svg)](https://www.npmjs.com/package/token-speed-tester)
[![å¼€æºåè®®](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![æµ‹è¯•](https://github.com/Cansiny0320/token-speed-tester/actions/workflows/publish.yml/badge.svg)](https://github.com/Cansiny0320/token-speed-tester/actions)

ä¸€ä¸ªå¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæµ‹è¯• LLM API çš„ Token è¾“å‡ºé€Ÿåº¦ã€‚æ”¯æŒ **Anthropic** å’Œ **OpenAI** å…¼å®¹çš„ APIï¼Œæä¾›è¯¦ç»†æŒ‡æ ‡åŒ…æ‹¬ TTFTï¼ˆé¦–å­—å»¶è¿Ÿï¼‰ã€ååé‡ã€å³°å€¼é€Ÿåº¦ä»¥åŠå¤šæ¬¡è¿è¡Œçš„ç»Ÿè®¡åˆ†æã€‚

## ç‰¹æ€§

- **åŒåè®®æ”¯æŒ**ï¼šå…¼å®¹ Anthropic Messages API å’Œ OpenAI Chat Completions API
- **æµå¼æ€§èƒ½æµ‹é‡**ï¼šä»¥æ¯«ç§’çº§ç²¾åº¦è®°å½•æ¯ä¸ª Token çš„åˆ°è¾¾æ—¶é—´
- **å…¨é¢æŒ‡æ ‡**ï¼š
  - **TTFT**ï¼ˆé¦–å­—å»¶è¿Ÿï¼‰ï¼šé¦–ä¸ª Token åˆ°è¾¾å‰çš„å»¶è¿Ÿ
  - **å¹³å‡é€Ÿåº¦**ï¼šæ¯ç§’å¹³å‡ Token æ•°
  - **å³°å€¼é€Ÿåº¦**ï¼š10 ä¸ª Token æ»‘åŠ¨çª—å£å†…çš„æœ€å¿«é€Ÿåº¦
  - **TPS æ›²çº¿**ï¼šæ•´ä¸ªæµå¼å“åº”ä¸­æ¯ç§’æ¥æ”¶çš„ Token æ•°
- **ç»Ÿè®¡åˆ†æ**ï¼šå¤šæ¬¡æµ‹è¯•è¿è¡Œçš„å‡å€¼ã€æœ€å°å€¼ã€æœ€å¤§å€¼å’Œæ ‡å‡†å·®
- **ASCII å¯è§†åŒ–**ï¼šç²¾ç¾çš„ç»ˆç«¯å›¾è¡¨å’Œæ•°æ®è¡¨æ ¼
- **è‡ªå®šä¹‰ç«¯ç‚¹**ï¼šæµ‹è¯•å…¼å®¹ OpenAI/Anthropic åè®®çš„ç¬¬ä¸‰æ–¹ API

## å®‰è£…

### å…¨å±€å®‰è£…ï¼ˆæ¨èï¼‰

```bash
npm install -g token-speed-tester
```

### ä½¿ç”¨ npxï¼ˆæ— éœ€å®‰è£…ï¼‰

```bash
npx token-speed-tester --api-key sk-xxx
```

### æœ¬åœ°å®‰è£…

```bash
npm install token-speed-tester
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
# æµ‹è¯• Anthropic APIï¼ˆé»˜è®¤ï¼‰
token-speed-test --api-key sk-ant-xxx

# æµ‹è¯• OpenAI API
token-speed-test --api-key sk-xxx --provider openai
```

### é«˜çº§é€‰é¡¹

```bash
# è‡ªå®šä¹‰æ¨¡å‹å’Œå¤šæ¬¡æµ‹è¯•
token-speed-test \
  --api-key sk-ant-xxx \
  --provider anthropic \
  --model claude-3-5-sonnet-20241022 \
  --runs 5

# æµ‹è¯•è‡ªå®šä¹‰ç«¯ç‚¹å’Œæç¤ºè¯
token-speed-test \
  --api-key sk-xxx \
  --provider openai \
  --url https://api.example.com/v1 \
  --model custom-model \
  --prompt "è§£é‡Šé‡å­è®¡ç®—" \
  --max-tokens 2048 \
  --runs 10
```

### æœ¬åœ°å¼€å‘

```bash
# å…‹éš†å¹¶å®‰è£…ä¾èµ–
git clone https://github.com/Cansiny0320/token-speed-tester.git
cd token-speed-tester
npm install

# ä½¿ç”¨ tsx ç›´æ¥è¿è¡Œ
npm run dev -- --api-key sk-ant-xxx

# æˆ–æ„å»ºåè¿è¡Œ
npm run build
node dist/index.js --api-key sk-ant-xxx
```

## å‘½ä»¤è¡Œé€‰é¡¹

| é€‰é¡¹ | ç®€å†™ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `--api-key` | `-k` | API Keyï¼ˆå¿…å¡«ï¼‰ | - |
| `--provider` | `-p` | API ç±»å‹ï¼š`anthropic` æˆ– `openai` | `anthropic` |
| `--model` | `-m` | æ¨¡å‹åç§° | æ ¹æ®æä¾›å•†è‡ªåŠ¨é€‰æ‹© |
| `--url` | `-u` | è‡ªå®šä¹‰ API ç«¯ç‚¹ | å®˜æ–¹ç«¯ç‚¹ |
| `--runs` | `-r` | æµ‹è¯•æ¬¡æ•° | `3` |
| `--prompt` | | æµ‹è¯•æç¤ºè¯ | "å†™ä¸€ç¯‡å…³äº AI çš„çŸ­æ–‡" |
| `--max-tokens` | | æœ€å¤§è¾“å‡º Token æ•° | `1024` |

### é»˜è®¤æ¨¡å‹

- **Anthropic**: `claude-3-5-sonnet-20241022`
- **OpenAI**: `gpt-4o-mini`

## è¾“å‡ºç¤ºä¾‹

```
ğŸš€ Token é€Ÿåº¦æµ‹è¯•å·¥å…·
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Provider: anthropic
Model: claude-3-5-sonnet-20241022
Max Tokens: 1024
Runs: 3
Prompt: å†™ä¸€ç¯‡å…³äº AI çš„çŸ­æ–‡
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â³ æ­£åœ¨è¿è¡Œæµ‹è¯•...

[è¿è¡Œ 1]
  TTFT: 523ms
  æ€»è€—æ—¶: 3245ms
  æ€» Token æ•°: 412
  å¹³å‡é€Ÿåº¦: 126.96 tokens/s
  å³°å€¼é€Ÿåº¦: 156.32 tokens/s

[è¿è¡Œ 2]
  TTFT: 487ms
  æ€»è€—æ—¶: 3189ms
  æ€» Token æ•°: 398
  å¹³å‡é€Ÿåº¦: 124.84 tokens/s
  å³°å€¼é€Ÿåº¦: 158.41 tokens/s

[è¿è¡Œ 3]
  TTFT: 501ms
  æ€»è€—æ—¶: 3312ms
  æ€» Token æ•°: 405
  å¹³å‡é€Ÿåº¦: 122.28 tokens/s
  å³°å€¼é€Ÿåº¦: 154.23 tokens/s

======================================================================
Token é€Ÿåº¦æµ‹è¯•æŠ¥å‘Š
======================================================================

ç»Ÿè®¡æ±‡æ€» (N=3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ ‡             â”‚       å‡å€¼ â”‚    æœ€å°å€¼ â”‚    æœ€å¤§å€¼ â”‚    æ ‡å‡†å·® â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TTFT (ms)       â”‚    503.67 â”‚   487.00 â”‚   523.00 â”‚    14.57 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ€»è€—æ—¶ (ms)      â”‚   3248.67 â”‚  3189.00 â”‚  3312.00 â”‚    51.92 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ€» Token æ•°     â”‚    405.00 â”‚  398.00 â”‚  412.00 â”‚     5.35 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¹³å‡é€Ÿåº¦        â”‚    124.69 â”‚  122.28 â”‚  126.96 â”‚     1.88 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å³°å€¼é€Ÿåº¦        â”‚    156.32 â”‚  154.23 â”‚  158.41 â”‚     1.82 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Token é€Ÿåº¦è¶‹åŠ¿å›¾ (TPS)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 120 â”¤                         â–ˆ         â”‚
â”‚ 100 â”¤                     â–ˆ â–ˆ â–ˆ â–ˆ       â”‚
â”‚  80 â”¤                 â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ     â”‚
â”‚  60 â”¤             â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ   â”‚
â”‚  40 â”¤         â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ   â”‚
â”‚  20 â”¤     â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ   â”‚
â”‚   0 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚     0s   1s   2s   3s   4s   5s   6s    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TPS åˆ†å¸ƒ
0.0-12.0 â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 45
12.0-24.0 â”‚â–ˆâ–ˆ 3
24.0-36.0 â”‚ 0
36.0-48.0 â”‚ 0
48.0-60.0 â”‚ 0
60.0-72.0 â”‚ 0
72.0-84.0 â”‚ 0
84.0-96.0 â”‚ 0
96.0-108.0 â”‚ 0
108.0-120.0 â”‚ 0

âœ… æµ‹è¯•å®Œæˆ!
```

## æŒ‡æ ‡è¯´æ˜

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| **TTFT** | é¦–å­—å»¶è¿Ÿ - ä»è¯·æ±‚åˆ°é¦–ä¸ª Token åˆ°è¾¾çš„æ—¶é—´ |
| **æ€»è€—æ—¶** | ä»è¯·æ±‚åˆ°æµå¼å“åº”å®Œæˆçš„å®Œæ•´æ—¶é•¿ |
| **æ€» Token æ•°** | æ¥æ”¶åˆ°çš„è¾“å‡º Token æ•°é‡ |
| **å¹³å‡é€Ÿåº¦** | æ¯ç§’å¹³å‡ Token æ•°ï¼ˆtotalTokens / totalTime Ã— 1000ï¼‰ |
| **å³°å€¼é€Ÿåº¦** | 10 ä¸ª Token æ»‘åŠ¨çª—å£å†…æµ‹é‡çš„æœ€å¿«é€Ÿåº¦ |
| **TPS æ›²çº¿** | æ•´ä¸ªæµå¼å“åº”ä¸­æ¯ç§’æ¥æ”¶çš„ Token æ•° |

## å¼€å‘

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
npm test

# ä½¿ç”¨ UI è¿è¡Œæµ‹è¯•
npm run test:ui

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### æ„å»º

```bash
npm run build
```

### å‘å¸ƒ

```bash
# è¡¥ä¸ç‰ˆæœ¬å‘å¸ƒ (1.0.3 -> 1.0.4)
npm run release

# æ¬¡è¦ç‰ˆæœ¬å‘å¸ƒ (1.0.3 -> 1.1.0)
npm run release:minor

# ä¸»è¦ç‰ˆæœ¬å‘å¸ƒ (1.0.3 -> 2.0.0)
npm run release:major
```

## æµ‹è¯•è¦†ç›–ç‡

æœ¬é¡¹ç›®ä¿æŒé«˜ä»£ç è¦†ç›–ç‡ï¼š

| è¦†ç›–ç‡ç±»å‹ | ç™¾åˆ†æ¯” |
|---------------|------------|
| è¯­å¥è¦†ç›–ç‡ | 99.19% |
| åˆ†æ”¯è¦†ç›–ç‡ | 94.73% |
| å‡½æ•°è¦†ç›–ç‡ | 100% |

## å¼€æºåè®®

MIT Â© [Cansiny0320](https://github.com/Cansiny0320)

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚

## ç›¸å…³é“¾æ¥

- [npm åŒ…](https://www.npmjs.com/package/token-speed-tester)
- [GitHub ä»“åº“](https://github.com/Cansiny0320/token-speed-tester)
- [é—®é¢˜åé¦ˆ](https://github.com/Cansiny0320/token-speed-tester/issues)
